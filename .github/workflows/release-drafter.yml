name: Release Drafter

on:
  push:
    branches:
      - main

jobs:
  update_release_draft:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Run Release Drafter
        uses: release-drafter/release-drafter@v5
        with:
          config-name: release-drafter.yml

name-template: Engine $RESOLVED_VERSION
tag-template: v$RESOLVED_VERSION
tag-prefix: v
template: |
  $CHANGES

exclude-labels:
  - skip changelog
  - release

# only include labelled pull requests
include-labels:
  - build
  - internal
  - deprecation
  - documentation
  - enhancement
  - fix
  - performance

# include pre releases as "full" releases when drafting release notes. Default: false.
include-pre-releases: true

change-template: '- $TITLE (#$NUMBER)'
change-title-escapes: '\<*_&'
replacers:
  # Remove conventional commits from titles
  - search: '/- (build|chore|ci|depr|docs|feat|fix|perf|refactor|release|test)(\(.*\))?(\!)?\: /g'
    replace: '- '

autolabeler:
  - label: build
    title:
      - '/^build/'
  - label: internal
    title:
      - '/^(chore|ci|refactor|test)/'
  - label: deprecation
    title:
      - '/^depr/'
  - label: documentation
    title:
      - '/^docs/'
  - label: enhancement
    title:
      - '/^feat/'
  - label: fix
    title:
      - '/^fix/'
  - label: performance
    title:
      - '/^perf/'
  - label: release
    title:
      - '/^release/'

categories:
  - title: âš ï¸ Deprecations
    labels: deprecation
  - title: ðŸš€ Performance improvements
    labels: performance
  - title: âœ¨ Enhancements
    labels: enhancement
  - title: ðŸž Bug fixes
    labels: fix
  - title: ðŸ“– Documentation
    labels: documentation
  - title: ðŸ“¦ Build system
    labels: build
  - title: ðŸ› ï¸ Other improvements
    labels: internal
